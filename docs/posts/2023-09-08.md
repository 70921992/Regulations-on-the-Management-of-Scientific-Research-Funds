---
draft: false
date: 2023-09-08
authors:
  - ronald_luo
categories:
  - Chronicle of Events
---

# 2023国赛数模记录

>   2023-09-07 --- 2023-09-10

## 问题一

发现要处理excel表格中的数据，直接使用之前在[手册上记录的代码](https://ronaldln.github.io/MyPamphlet/python%E7%9B%B8%E5%85%B3/openpyxl%28%E7%94%A8%E4%BA%8Eexcel%29/#1)

得到一个二维的列表，

然后由于要将每个商品每个季度的销量求和，并为了方便查找，打算将数据存在一个新的字典中，

而本来是打算采用再开一个列表来记录已经记录过信息的商品(记录过就可以直接加上，没记录过还需要初始化一下)，结果发现，并不需要开一个新的列表，[字典可以直接判断是否含有某个key](https://ronaldln.github.io/MyPamphlet/python%E7%9B%B8%E5%85%B3/python%E8%AF%AD%E8%A8%80/#1)：

```python
# codes = []
xiaoliang = {}
for data in datas2:
    if data[2] not in xiaoliang:
        # codes.append(data[2])
        xiaoliang[data[2]] = {y * 100 + s: 0 for y in range(2020, 2024) for s in range(1, 5)}
    xiaoliang[data[2]][get_season(data[0])] += data[3]
```

---

并且，从excel中读出来的数据的时间是 `datetime` 类型的，不知道要如何获取单独的年份和月份，

所以写注释让copilot自动生成了一个函数(稍加修改以获取想要的格式)：

```python
# 定义一个函数，传入datetime，判断在哪一年的哪个季度中
def get_season(date):
    season = 0
    if date.month in [1, 2, 3]:
        season = 1
    elif date.month in [4, 5, 6]:
        season = 2
    elif date.month in [7, 8, 9]:
        season = 3
    elif date.month in [10, 11, 12]:
        season = 4
    return int(date.year * 100 + season)
```

才知道datetime获取月份年份可以用 *`.属性`* 的方法获得年份和月份等信息([手册](https://ronaldln.github.io/MyPamphlet/python%E7%9B%B8%E5%85%B3/python%E8%AF%AD%E8%A8%80/#7))

---

以及，由于不知什么原因，从excel读出的数据丢失了一些精度，所以需要四舍五入一下，通过copilot知道[舍入可以借助 `round()` 函数](https://ronaldln.github.io/MyPamphlet/python%E7%9B%B8%E5%85%B3/python%E8%AF%AD%E8%A8%80/#6)

---

最后由于在使用写入excel的函数时，不知为何报错，所以让copilot生成了一个[把列表写入csv文件的函数](https://ronaldln.github.io/MyPamphlet/python%E7%9B%B8%E5%85%B3/python%E8%AF%AD%E8%A8%80/#8)：

```python
# 定义一个函数，将数据写入 csv 文件中
def write_data(file_name, data_list):
    # 打开 csv 文件
    with open(file_name, "w", encoding="utf-8") as f:
        # 使用循环将数据写入 csv 文件中
        for data in data_list:
            # 将列表转换为字符串
            data_str = ",".join([str(x) for x in data])
            # 将字符串写入文件中
            f.write(data_str + "\n")
```

